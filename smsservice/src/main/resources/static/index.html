<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
<h1>main执行完成后才显示</h1>
<a class="play" id="audioBtn" style="cursor:pointer;" onclick="audioAutoPlay()">123</a>
<audio id="bgMusic" src="music.mp3" preload loop="loop"></audio>

</body>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript">
    function main() {
        var isWelcome = confirm("Welcome");
        if (isWelcome) {
            alert("123");
        } else {
            var value = prompt("Prompt message", "default value");
            if (value != null) {
                alert(value);
            }
        }
    }

    function audioAutoPlay() {
        putData();
        var audio = document.getElementById('bgMusic');
        var btn = document.getElementById('audioBtn');
        var isPlay = false;
        if (audio.paused) {
            isPlay = true;
            audio.play();
        } else {
            isPlay = false;
            audio.pause();
        }
    }

    function putData(action, extra) {
        const dataContent = {
            action: action,
            time: new Date().toLocaleString(),
            extra: extra
        };
        // $.get("https://www.baidu.com", data, function (data, status) {
        //     console.log('${data} and status is ${status}');
        // })
        $.ajax({
            type: "POST",
            url: "/action",
            data: JSON.stringify(dataContent),
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                console.log("success " + result);
            },
            error: function (error) {
                console.log("error " + error);
            }
        });
    }

    main();
</script>

</html>